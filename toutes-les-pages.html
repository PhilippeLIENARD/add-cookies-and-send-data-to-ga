
<!-- Landing pages (toutes les pages du site 

Installer le code en bas de page, avant balise de fermeture </body>

jQuery est requis

-->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script>


let currentURL = window.location.href;
const cookieName = "bluetimeadt";
let cookieDate = new Date();
cookieDate.setTime(cookieDate.getTime() + 31536000000);
let inputCookie;
let cookieResult;

let sourceTrackerArray = [
   {
    KeyToMatch: "gclid",
    cookieName: cookieName,
    cookieValue: "btadw1",
    cookieAffiliation : "DirectAdwords"
  },

  {
    KeyToMatch: "lamaisondesartistes",
    cookieName: cookieName,
    cookieValue: "btadw2",
    cookieAffiliation : "lamaisondesartistes"
  }
  
];

function getCookie(cname) {
  let name = cname + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(";");

  console.log("* * * *  LOG COOKIE FUNCTION -- ca -- " + ca);

  for (let i = 0; i < ca.length; i++) {
    let c = ca[i];

    while (c.charAt(0) == " ") {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }

  return false;
}

function bluetimeSourceManager(){
inputCookie = getCookie(cookieName);  
     
    $.each( sourceTrackerArray , function(key,value){                  
                   
             let counter = key+1;            

             let thisKey_jQuery = value.KeyToMatch;
             let thisCookie_jQuery = value.cookieValue;   

             if(currentURL.indexOf(thisKey_jQuery) > 0){
              document.cookie = cookieName + " = " + thisCookie_jQuery + "; expires = " + cookieDate + "; path=/";               
              console.log("++++++++ EACH : URL DONE ::::: " + counter);

             } else if (currentURL.indexOf(thisKey_jQuery) < 0) {
                console.log("- - -  EACH : URL FAIL ::::: " + counter)
             }
			 
             cookieResult = getCookie(cookieName); 
             console.log(typeof thisKey_jQuery + " ; " + thisKey_jQuery.length);  

    });
}


$(document).ready(function(){

	bluetimeSourceManager();
	 
	console.log("INPUT COOKIE : " + inputCookie + "  OUTPUT COOKIE => " + cookieResult );

});

</script>